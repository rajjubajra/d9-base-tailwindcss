<div class="container mx-auto px-4">

  <header role="banner">
    {{ page.header }}
  </header>

  {{ page.primary_menu }}
  {{ page.secondary_menu }}

  {{ page.breadcrumb }}

  {{ page.highlighted }}

  {{ page.help }}

  <main role="main">
    <a id="main-content" tabindex="-1">Invoice page</a>{# link is in html.html.twig #}

    <div class="md:flex -mx-4">
      <div class="md:flex-1 p-4">
        <div id="react-container"></div>
        {{ page.content }}
        <div id="invoice-list"></div>
      </div>{# /.layout-content #}

      {% if page.sidebar_first %}
        <aside class="md:w-1/4 p-4" role="complementary">
          {{ page.sidebar_first }}
          <div></div>
        </aside>
      {% endif %}

      {% if page.sidebar_second %}
        <aside class="md:w-1/4" role="complementary">
          {{ page.sidebar_second }}
        </aside>
      {% endif %}
    </div>
  </main>

  {% if page.footer %}
    <footer role="contentinfo">
      {{ page.footer }}
    </footer>
  {% endif %}

</div>{# /.layout-container #}


<script>
  window.onload = function(){
    try{
      const url = `/d9-base/jsonapi/node/invoice`;
      invoiceList(url);
    }catch(error){
      console.log("Error:", error);
    }
  }

  const invoiceList = async (url) => {
    const response = await fetch(url,{
      method: 'GET',
      headers:{
        Accept: 'application/vnd.api+json'
      }
    })    
    const invoices = await response.json();
    console.log(invoices);

    invoices.data.map(item=>{
      const {attributes:{field_old_invoice_number, field_old_invoice_date}} = item;
      const items = `
      <div>${field_old_invoice_date}</div>
      <div>${field_old_invoice_number}</div>
      <div>
        <a href="/d9-base/invoice-print/${item.id}">Print</a>
      </div>
      `;

      document.getElementById("invoice-list").innerHTML += items;

    })
    
  }


</script>